(self.webpackChunk_kne_components_components_core=self.webpackChunk_kne_components_components_core||[]).push([[5654,9034,1190],{8593:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>H,withExportTable:()=>z});const n=e=>({"en-US":()=>s.e(8781).then(s.bind(s,58781)),"zh-CN":()=>s.e(2355).then(s.bind(s,42355))}[e]());var r=s(58609);const a="style_right-options-modal__0FYSr__otc6t",o="style_left-options-col__dZs-a__otc6t",l="style_right-options-col__-bGqN__otc6t",i="style_move-icon__Kd4U2__otc6t",c="style_close-icon__HG1G5__otc6t",d="style_columns-control-content-item__SK820__otc6t",u="style_is-drag__7dzHq__otc6t",m="style_sortable-drag__Btml4__otc6t",p="style_sortable-ghost__L0Tis__otc6t",h="style_right-header__pPtqi__otc6t",x="style_right-title__VutTR__otc6t",_="style_right-desc__dUwAi__otc6t",f="style_divider__GpvGk__otc6t",g="style_modal-footer-tip__GMxOE__otc6t";var j=s(73884),v=s(21079),y=s(83136),C=s.n(y),b=s(55199),N=s(3382),k=s(64671),T=s(76441),w=s(1488),A=s.n(w),M=s(67390),S=s(87558),E=s(76329),F=s(63361),O=s(33097),P=s.n(O),D=s(70579);const B=e=>{let{groupName:t,list:s,selected:n,onChange:a}=e;const o=(0,j.useMemo)((()=>s.every((e=>n.some((t=>t===e.name))))),[s,n]);return(0,D.jsx)(D.Fragment,{children:(0,D.jsxs)(b.Row,{gutter:[24,12],justify:"space-between",children:[(0,D.jsx)(b.Col,{className:x,children:t}),(0,D.jsx)(b.Col,{children:(0,D.jsx)(b.Checkbox,{checked:o,onChange:e=>{const t=e.target.checked?(0,v.union)(n.slice(0),s.map((e=>e.name))):n.slice(0).filter((e=>!s.some((t=>t.name===e))));a(t)},children:(0,D.jsx)(r.FormattedMessage,{id:"selectedAll",moduleName:"ExportTable",defaultMessage:"\u5168\u9009"})})}),(0,D.jsx)(b.Col,{span:24,children:(0,D.jsx)(b.Space,{className:C()("full-space"),wrap:!0,size:[24,12],children:(s||[]).map((e=>(0,D.jsx)(b.Checkbox,{checked:n.some((t=>t===e.name)),onChange:t=>{let s=n.slice(0);t.target.checked?s.push(e.name):s=s.filter((t=>t!==e.name)),a(s)},children:e.titleText||e.title||"\u672a\u547d\u540d\u5217"},e.name)))})})]})})},R=e=>{let{options:t,children:s}=e;return t?(0,D.jsxs)(b.Row,{wrap:!1,children:[(0,D.jsx)(b.Col,{flex:1,className:o,children:s}),(0,D.jsx)(b.Col,{className:l,children:t})]}):s},G=(0,j.forwardRef)(((e,t)=>{let{columns:s,data:a}=e;const[o,l]=(0,j.useState)((()=>{const e=Array.isArray(a)?a:JSON.parse(a)||[];return Array.isArray(e)&&(e||[]).filter((e=>!!e)).length>0?e.filter((e=>!!e)):s.filter((e=>e.hasOwnProperty("exportHidden")&&!0!==e.exportHidden||!0!==e.hidden)).map((e=>e.name))})),g=(0,j.useMemo)((()=>(0,v.groupBy)(s,(e=>e.groupName))),[s]),y=(0,j.useMemo)((()=>{const e=new Map(s.map((e=>[e.name,e])));return(o||[]).filter((e=>s.some((t=>t.name===e)))).map((t=>e.get(t)))}),[s,o]);return(0,j.useImperativeHandle)(t,(()=>({data:o})),[o]),(0,D.jsx)(r.IntlProvider,{importMessages:n,moduleName:"ExportTable",children:(0,D.jsx)(R,{options:(0,D.jsxs)("div",{children:[(0,D.jsxs)("div",{className:h,children:[(0,D.jsxs)("div",{className:x,children:[(0,D.jsx)(r.FormattedMessage,{id:"rightTitle",moduleName:"ExportTable",defaultMessage:"\u5df2\u9009\u7684\u5b57\u6bb5"}),"\uff1a"]}),(0,D.jsx)("div",{className:_,children:(0,D.jsx)(r.FormattedMessage,{id:"rightDesc",moduleName:"ExportTable",defaultMessage:"\u6309\u4f4f\u62d6\u62fd\u53ef\u8fdb\u884c\u6392\u5e8f"})})]}),(0,D.jsx)(T.ReactSortable,{selectedColumns:o,list:y,filter:".ignore-elements",dragClass:m,ghostClass:p,forceFallback:!0,setList:e=>{const t=e.map((e=>e.name));setTimeout((()=>{l([...t])}),50)},animation:300,delayOnTouchStart:!0,delay:2,children:y.map(((e,t)=>(0,D.jsx)(b.List.Item,{className:C()(d,u),children:(0,D.jsxs)(b.Row,{justify:"space-between",align:"middle",style:{flex:1},children:[(0,D.jsx)(b.Col,{children:(0,D.jsxs)(b.Space,{size:2,children:[(0,D.jsx)(k.default,{type:"icon-paixu",className:C()(i,"move-icon")}),(0,D.jsx)("span",{children:e.titleText||e.title||"\u672a\u547d\u540d\u5217"})]})}),(0,D.jsx)(b.Col,{onClick:t=>{t.preventDefault(),t.stopPropagation();let s=o.slice(0);s=s.filter((t=>t!==e.name)),setTimeout((()=>{l([...s])}),50)},children:(0,D.jsx)(k.default,{type:"icon-close-thin",className:C()(c,"close-icon")})})]})},e.name+t)))})]}),children:(0,D.jsx)(b.Space,{className:C()("full-space"),direction:"vertical",split:(0,D.jsx)(b.Divider,{className:f}),children:Object.keys(g).map(((e,t)=>(0,D.jsx)(B,{selected:o,groupName:e,list:g[e],onChange:e=>{l(e)}},e+t)))})})})}));G.defaultProps={columns:[]};const z=e=>t=>{const s=A()(t,["onClick"]),n=(0,j.useRef)(null),{name:r,saveDataApi:o,featureId:l}=t,{exportTableServerApis:i}=(0,E.usePreset)(),c=o||i&&i.saveDataApi,d=(0,N.useModal)();return(0,D.jsx)(e,{onClick:async()=>{t.onClick&&t.onClick();let e="function"===typeof t.columns?await t.columns():t.columns;e=e.filter((e=>!0!==e.exportHidden));const o=(e=>{const t=(0,S.withFetch)(e);return s=>{const{name:n,getDataApi:r}=s,{exportTableServerApis:a}=(0,E.usePreset)(),o=r||a&&a.getDataApi;return n&&a&&a.getDataApi?(0,D.jsx)(t,{...s,...o(n),error:(0,D.jsx)(e,{...s})}):(0,D.jsx)(e,{...s})}})((t=>(e=>{let{children:t}=e;return l?(0,D.jsx)(F.default,{id:l,children:t}):t({})})({children:r=>{let{options:a}=r;return e=e.filter((e=>!Array.isArray(P()(a,"hiddenColumns"))||-1===a.hiddenColumns.indexOf(e.name))),(0,D.jsx)(G,{...t,...s,columns:e,ref:n})}})));d({title:t.title||"\u5bfc\u51fa\u6570\u636e",...s,className:a,footer:()=>(0,D.jsxs)(b.Space,{size:4,className:g,children:[(0,D.jsx)(k.default,{type:"icon-xinxi-miaobian"}),(0,D.jsx)("span",{children:"\u5bfc\u51fa\u540e\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u4fdd\u5b58\u60a8\u672c\u6b21\u9009\u62e9\u7684\u5b57\u6bb5\u53ca\u6392\u5e8f"})]}),footerButtons:[{children:"\u53d6\u6d88"},{type:"primary",children:"\u5bfc\u51fa",onClick:async()=>{var e;if(0===(null===(e=n.current)||void 0===e?void 0:e.data.length))return b.message.error(t.selectedTip||"\u8bf7\u9009\u62e9\u8981\u5bfc\u51fa\u7684\u5b57\u6bb5"),!1;const s=!c||await c({name:r,data:n.current.data});if(!1!==s){(0,S.getCache)().delByCacheName("EXPORT_TABLE_CONFIG_".concat(r));return!1!==(!t.onExport||await t.onExport({data:n.current.data,downloadBlobFile:M.downloadBlobFile}))}return!1!==s}}],children:(0,D.jsx)(o,{...(0,v.pick)(t,["name","getDataApi"])})})}})},H=z((e=>(0,D.jsx)(r.IntlProvider,{importMessages:n,moduleName:"ExportTable",children:(0,D.jsx)(b.Button,{...e,size:"small",children:e.actionText||(0,D.jsx)(r.FormattedMessage,{id:"actionText",moduleName:"ExportTable",defaultMessage:"\u5bfc\u51fa\u6570\u636e"})})})))},94710:e=>{e.exports=function(e,t,s,n){for(var r=-1,a=null==e?0:e.length;++r<a;){var o=e[r];t(n,o,s(o),e)}return n}},32952:(e,t,s)=>{var n=s(45652);e.exports=function(e,t,s,r){return n(e,(function(e,n,a){t(r,e,s(e),a)})),r}},45652:(e,t,s)=>{var n=s(94664),r=s(76516)(n);e.exports=r},99910:e=>{e.exports=function(e,t){for(var s,n=-1,r=e.length;++n<r;){var a=t(e[n]);void 0!==a&&(s=void 0===s?a:s+a)}return s}},19449:(e,t,s)=>{var n=s(94710),r=s(32952),a=s(9096),o=s(54052);e.exports=function(e,t){return function(s,l){var i=o(s)?n:r,c=t?t():{};return i(s,e,a(l,2),c)}}},76516:(e,t,s)=>{var n=s(6571);e.exports=function(e,t){return function(s,r){if(null==s)return s;if(!n(s))return e(s,r);for(var a=s.length,o=t?a:-1,l=Object(s);(t?o--:++o<a)&&!1!==r(l[o],o,l););return s}}},26304:(e,t,s)=>{var n=s(53871),r=s(76759);e.exports=function(e,t,s){var a=null==e?0:e.length;return a?(t=s||void 0===t?1:r(t),n(e,0,(t=a-t)<0?0:t)):[]}},39835:(e,t,s)=>{var n=s(71775),r=s(19449),a=Object.prototype.hasOwnProperty,o=r((function(e,t,s){a.call(e,s)?e[s].push(t):n(e,s,[t])}));e.exports=o},56641:(e,t,s)=>{var n=s(26989);e.exports=function(e,t,s){var r=(s="function"==typeof s?s:void 0)?s(e,t):void 0;return void 0===r?n(e,t,void 0,s):!!r}},60262:(e,t,s)=>{var n=s(99910),r=s(33279);e.exports=function(e){return e&&e.length?n(e,r):0}},76759:(e,t,s)=>{var n=s(37303);e.exports=function(e){var t=n(e),s=t%1;return t===t?s?t-s:t:0}},17448:()=>{},71975:()=>{}}]);
//# sourceMappingURL=5654.07e4b13e.chunk.js.map