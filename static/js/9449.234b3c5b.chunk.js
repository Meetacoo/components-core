(self.webpackChunk_kne_components_components_core=self.webpackChunk_kne_components_components_core||[]).push([[9449,9034,1190],{2093:(e,t,s)=>{"use strict";s.r(t),s.d(t,{DragArea:()=>K,DragAreaOuter:()=>J,DragButton:()=>X,FileUpload:()=>ne,Title:()=>Y,UploadButton:()=>q,UploadTips:()=>V,default:()=>se});var i=s(73884),n=s(33097),a=s.n(n),l=s(55199);const r="style_file-list-outer__wPhbb__DdjY3",o="style_file-list-title__zXM5r__DdjY3",c="style_container__P4RaF__DdjY3",d="style_file-preview-inner__cvE72__DdjY3",p="style_file-preview__M-Asq__DdjY3",u="style_drag-area__Q+lm7__DdjY3",m="style_upload-drag-close__u5o8W__DdjY3",x="style_upload-drag-tips__z7puZ__DdjY3",g="style_upload-drag-icon__sGGoS__DdjY3",j="style_upload-drag-title__9Afmb__DdjY3",_="style_upload-drag-text__o38vS__DdjY3",h="style_title-group__8IJkS__DdjY3",f="style_upload-btn__Q+Jxn__DdjY3",v="style_total-count__z1fyd__DdjY3",y="style_file-select__mHqyI__DdjY3",S="style_file-name__QkvMn__DdjY3",N="style_file-select-info__fOLiM__DdjY3",D="style_file-select-option__AbDrD__DdjY3";var F=s(75087),P=s.n(F),L=s(74065),b=s.n(L),w=s(57469),C=s.n(w),M=s(64671),T=s(67390),z=s(58609),I=s(70579);const E=e=>{let{currentTab:t,setCurrentTab:s,previewMap:i,previewList:n,getPermission:a,currentPreviewFileId:r,setCurrentPreviewFileId:c,itemApis:d,children:p,maxWidth:u,getPopupContainer:m}=e;return(0,I.jsx)("div",{className:o,children:(0,I.jsxs)(l.Row,{align:"middle",justify:"space-between",wrap:!1,children:[(0,I.jsx)(l.Col,{children:(0,I.jsxs)(l.Space,{className:h,size:4,children:[(0,I.jsx)(l.Segmented,{value:t,onChange:s,options:[{label:(0,I.jsxs)(l.Space,{size:4,children:[(0,I.jsx)(M.default,{type:"icon-shitu-liebiao"}),(0,I.jsx)(z.FormattedMessage,{id:"listText",moduleName:"FileList"})]}),value:"list"},{label:(0,I.jsxs)(l.Space,{size:4,children:[(0,I.jsx)(M.default,{type:"icon-shitu-yulan"}),(0,I.jsx)(z.FormattedMessage,{id:"previewText",moduleName:"FileList"})]}),value:"preview"}]}),"preview"===t&&r&&i.get(r)&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(l.Select,{className:y,bordered:!1,popupMatchSelectWidth:!1,value:r,onChange:c,getPopupContainer:m,children:n.map((e=>{let{filename:t,userName:s,date:i,ossId:n}=e;return(0,I.jsx)(l.Select.Option,{className:D,value:n,children:(0,I.jsxs)(l.Space,{direction:"vertical",children:[(0,I.jsxs)(l.Space,{size:4,align:"start",children:[(0,I.jsx)(P(),{type:b()(t.split(".")),size:14}),(0,I.jsx)(l.Typography.Text,{className:S,ellipsis:!0,style:{"--max-width":"".concat(u,"px")},children:t})]}),s||i?(0,I.jsxs)(l.Space,{className:N,size:24,children:[(0,I.jsxs)("div",{children:[(0,I.jsx)(z.FormattedMessage,{id:"uploadUser",moduleName:"FileList"}),":",s]}),(0,I.jsxs)("div",{children:[(0,I.jsx)(z.FormattedMessage,{id:"uploadTime",moduleName:"FileList"}),":",i&&C()(i).format("YYYY-MM-DD HH:mm:ss")]})]}):null]})},n)}))}),(0,I.jsx)(T.OptionButtons,{hasPreview:!1,getPermission:a,item:i.get(r),apis:d}),(0,I.jsx)("div",{className:v,children:(0,I.jsx)(z.FormattedMessage,{id:"totalCount",values:{count:n.length},moduleName:"FileList"})})]})]})}),(0,I.jsx)(l.Col,{children:p})]})})};E.defaultProps={maxWidth:260};const Y=E,A=e=>({"en-US":()=>s.e(5714).then(s.bind(s,63333)),"zh-CN":()=>s.e(8795).then(s.bind(s,48795))}[e]());var O=s(70720),U=s.n(O),k=s(83136),B=s.n(k);const R=(0,i.createContext)({}),{Provider:G}=R,W=()=>(0,i.useContext)(R);var H=s(29574),Q=s(81348);const X=e=>{let{children:t}=e;const{onOpenChange:s,getDragButtonEl:i}=W();return(0,I.jsx)("div",{ref:i,className:f,onClick:()=>{s((e=>!e))},children:(0,I.jsxs)(l.Typography.Text,{className:"ant-btn",children:[(0,I.jsx)(M.default,{type:"icon-tuozhuaishangchuan"}),t||(0,I.jsx)(z.FormattedMessage,{id:"dragText",moduleName:"FileList"})]})})},q=e=>{let{children:t}=e;const{accept:s,onFileSelected:i}=W();return(0,I.jsxs)(H.AG,{className:f,accept:s,multiple:!0,onChange:i,children:[(0,I.jsx)(M.default,{type:"icon-tianjia"}),t]})},J=e=>{let{title:t,accept:s,fileSize:n,maxLength:a,onFileSelected:o,children:d,className:p}=e;const[u,m]=(0,i.useState)(!1),x=(0,i.useRef)(null),g=U()((e=>{x.current&&(x.current.contains(e.target)||e.target===x.current||m(!1))}));return(0,I.jsx)(z.IntlProvider,{importMessages:A,moduleName:"FileList",children:(0,I.jsx)(G,{value:{open:u,onOpenChange:m,accept:s,fileSize:n,maxLength:a,onFileSelected:o,getDragButtonEl:e=>{x.current=e}},children:(0,I.jsxs)(l.Space,{className:r,direction:"vertical",children:[t,(0,I.jsx)("div",{className:B()(c,p),ref:g,onDragEnter:()=>{m(!0)},children:d})]})})})};J.defaultProps={fileSize:20,accept:[".png",".jpg",".pdf",".docx",".doc"]};const V=e=>{let{icon:t,title:s,renderTips:i}=e;const{accept:n,fileSize:a,maxLength:l}=W(),r=i((0,z.useIntl)({moduleName:"FileList"}).formatMessage({id:"dragTips"},{accept:n.map((e=>e.replace(/^\./,""))).join("\u3001"),size:a}),{fileSize:a,maxLength:l,accept:n});return(0,I.jsxs)("div",{className:B()(x,"upload-drag-tips"),children:[(0,I.jsx)("div",{className:g,children:t||(0,I.jsx)(M.default,{type:"icon-shangchuan",size:64})}),(0,I.jsx)("div",{className:j,children:s||(0,I.jsx)(z.FormattedMessage,{id:"dragTitle",moduleName:"FileList"})}),(0,I.jsx)("div",{className:_,children:r})]})};V.defaultProps={renderTips:e=>e};const Z=e=>{let{children:t,className:s}=e;const{open:i,accept:n,onOpenChange:a,onFileSelected:r}=W();return i?(0,I.jsxs)("div",{className:B()(u,s),onDragOver:e=>{e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:e=>{if(e.stopPropagation(),e.preventDefault(),0===e.dataTransfer.files.length)return;a(!1);const t=Array.from(e.dataTransfer.files).filter((e=>(0,Q.A)(e,n)));r(t)},onDragEnd:()=>{a(!1)},children:[(0,I.jsx)(l.Button,{className:m,type:"text",shape:"circle",size:"small",icon:(0,I.jsx)(M.default,{type:"icon-close-bold"}),onClick:()=>{a(!1)}}),t]}):null};Z.defaultProps={children:(0,I.jsx)(V,{})};const K=Z;var $=s(10419),ee=s(76329);const te=e=>{var t;let{maxLength:s,list:n,setList:r,defaultTab:o,apis:c,getPermission:u,titleExtra:m,fileSize:x,accept:g,getPopupContainer:j}=e;const{apis:_}=(0,ee.usePreset)(),h=Object.assign({},_,c),{fileList:f,onFileSelected:v}=(0,H.lN)({maxLength:s,multiple:!0,value:n,onChange:r,concurrentCount:1,onAdd:()=>{S("list")},onSave:h.onSave,ossUpload:h.ossUpload}),[y,S]=(0,i.useState)(o),{formatMessage:N}=(0,z.useIntl)({moduleName:"FileList"}),{message:D}=l.App.useApp(),F=(0,i.useMemo)((()=>new Map(n.map((e=>[e.ossId,e])))),[n]),[P,L]=(0,i.useState)(a()(n,"[0].ossId",null));(0,i.useEffect)((()=>{P&&F.get(P)||L(a()(n,"[0].ossId",null))}),[n,F,P]);const b={onPreview:e=>{L(e.ossId),S("preview")},onDelete:async e=>{h.onDelete&&await h.onDelete(e),r((t=>{const s=t.slice(0),i=t.findIndex((t=>{let{ossId:s}=t;return s===e.ossId}));return i>-1&&s.splice(i,1),s})),D.success(N({id:"successDelete"},{name:e.filename}))},onEdit:async e=>{let{formData:t,item:s}=e;h.onEdit&&await h.onEdit({formData:t,item:s}),r((e=>{const i=e.slice(0),n=e.findIndex((e=>{let{ossId:t}=e;return t===s.ossId}));return n>-1&&i.splice(n,1,Object.assign({},s,{filename:t.name})),i})),D.success(N({id:"successEditFileName"},{name:s.filename}))}},w="function"===typeof m?m({currentPreviewFileId:P,currentTab:y}):m;return(0,I.jsxs)(J,{title:(0,I.jsx)(Y,{currentTab:y,setCurrentTab:S,previewMap:F,previewList:n,getPermission:u,currentPreviewFileId:P,setCurrentPreviewFileId:L,itemApis:b,getPopupContainer:j,children:(0,I.jsxs)(l.Space,{split:(0,I.jsx)(l.Divider,{type:"vertical"}),children:[w,u("add",{})?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(X,{children:(0,I.jsx)(z.FormattedMessage,{id:"dragText",moduleName:"FileList"})}),(0,I.jsx)(q,{children:(0,I.jsx)(z.FormattedMessage,{id:"uploadFile",moduleName:"FileList"})})]}):null]})}),fileSize:x,maxLength:s,onFileSelected:v,accept:g,children:["list"===y?(0,I.jsx)(T.List,{dataSource:[...f,...n],getPermission:u,apis:b}):null,"preview"===y?P?(0,I.jsx)("div",{className:d,children:(0,I.jsx)($.default,{className:p,id:P,apis:h,originName:null===(t=F.get(P))||void 0===t?void 0:t.filename})}):(0,I.jsx)(l.Empty,{image:l.Empty.PRESENTED_IMAGE_SIMPLE,className:"ant-empty-normal"}):null,(0,I.jsx)(K,{})]})};te.defaultProps={defaultTab:"list",titleExtra:null,accept:[".png",".jpg",".pdf",".docx",".doc"],fileSize:20,maxLength:Number.MAX_VALUE,getPermission:()=>!0};const se=e=>(0,I.jsx)(z.IntlProvider,{importMessages:A,moduleName:"FileList",children:(0,I.jsx)(te,{...e})}),ie=e=>{let{maxLength:t,list:s,setList:i,apis:n,getPermission:a,fileSize:r,accept:o}=e;const{apis:c}=(0,ee.usePreset)(),d=Object.assign({},c,n),{fileList:p,onFileSelected:u}=(0,H.lN)({maxLength:t,multiple:!0,value:s,onChange:i,concurrentCount:1,onSave:d.onSave,ossUpload:d.ossUpload});return(0,I.jsxs)(J,{title:(0,I.jsxs)(l.Row,{children:[(0,I.jsx)(l.Col,{flex:1}),(0,I.jsx)(l.Col,{children:(0,I.jsxs)(l.Space,{split:(0,I.jsx)(l.Divider,{type:"vertical"}),children:[(0,I.jsx)(X,{}),(0,I.jsx)(q,{children:"\u4e0a\u4f20"})]})})]}),fileSize:r,maxLength:t,onFileSelected:u,accept:o,children:[(0,I.jsx)(T.List,{dataSource:[...p,...s],getPermission:a,apis:d}),(0,I.jsx)(K,{})]})};ie.defaultProps={accept:[".png",".jpg",".pdf",".docx",".doc"],fileSize:20,maxLength:Number.MAX_VALUE,getPermission:()=>!0};const ne=ie},94710:e=>{e.exports=function(e,t,s,i){for(var n=-1,a=null==e?0:e.length;++n<a;){var l=e[n];t(i,l,s(l),e)}return i}},32952:(e,t,s)=>{var i=s(45652);e.exports=function(e,t,s,n){return i(e,(function(e,i,a){t(n,e,s(e),a)})),n}},45652:(e,t,s)=>{var i=s(94664),n=s(76516)(i);e.exports=n},99910:e=>{e.exports=function(e,t){for(var s,i=-1,n=e.length;++i<n;){var a=t(e[i]);void 0!==a&&(s=void 0===s?a:s+a)}return s}},19449:(e,t,s)=>{var i=s(94710),n=s(32952),a=s(9096),l=s(54052);e.exports=function(e,t){return function(s,r){var o=l(s)?i:n,c=t?t():{};return o(s,e,a(r,2),c)}}},76516:(e,t,s)=>{var i=s(6571);e.exports=function(e,t){return function(s,n){if(null==s)return s;if(!i(s))return e(s,n);for(var a=s.length,l=t?a:-1,r=Object(s);(t?l--:++l<a)&&!1!==n(r[l],l,r););return s}}},26304:(e,t,s)=>{var i=s(53871),n=s(76759);e.exports=function(e,t,s){var a=null==e?0:e.length;return a?(t=s||void 0===t?1:n(t),i(e,0,(t=a-t)<0?0:t)):[]}},39835:(e,t,s)=>{var i=s(71775),n=s(19449),a=Object.prototype.hasOwnProperty,l=n((function(e,t,s){a.call(e,s)?e[s].push(t):i(e,s,[t])}));e.exports=l},56641:(e,t,s)=>{var i=s(26989);e.exports=function(e,t,s){var n=(s="function"==typeof s?s:void 0)?s(e,t):void 0;return void 0===n?i(e,t,void 0,s):!!n}},60262:(e,t,s)=>{var i=s(99910),n=s(33279);e.exports=function(e){return e&&e.length?i(e,n):0}},76759:(e,t,s)=>{var i=s(37303);e.exports=function(e){var t=i(e),s=t%1;return t===t?s?t-s:t:0}},17448:()=>{},71975:()=>{}}]);
//# sourceMappingURL=9449.234b3c5b.chunk.js.map