(self.webpackChunk_kne_components_components_core=self.webpackChunk_kne_components_components_core||[]).push([[7244,1264],{73876:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>z,withExportTable:()=>G});const r=e=>({"en-US":()=>n.e(2456).then(n.bind(n,12456)),"zh-CN":()=>n.e(6736).then(n.bind(n,6736))}[e]());var s=n(74879);const a="style_right-options-modal__0FYSr__rgnvX",l="style_left-options-col__dZs-a__rgnvX",o="style_right-options-col__-bGqN__rgnvX",i="style_move-icon__Kd4U2__rgnvX",c="style_close-icon__HG1G5__rgnvX",d="style_columns-control-content-item__SK820__rgnvX",u="style_is-drag__7dzHq__rgnvX",m="style_sortable-drag__Btml4__rgnvX",p="style_sortable-ghost__L0Tis__rgnvX",h="style_right-header__pPtqi__rgnvX",x="style_right-title__VutTR__rgnvX",_="style_right-desc__dUwAi__rgnvX",g="style_divider__GpvGk__rgnvX",f="style_modal-footer-tip__GMxOE__rgnvX";var v=n(46964),j=n(43548),y=n(79272),C=n.n(y),b=n(96164),N=n(79056),k=n(5520),T=n(97912),w=n(5e4),A=n.n(w),M=n(48588),X=n(84768),S=n(68086),E=n(54948),F=n(58564),O=n.n(F),P=n(82496);const D=e=>{let{groupName:t,list:n,selected:r,onChange:a}=e;const l=(0,v.useMemo)((()=>n.every((e=>r.some((t=>t===e.name))))),[n,r]);return(0,P.jsx)(P.Fragment,{children:(0,P.jsxs)(b.Row,{gutter:[24,12],justify:"space-between",children:[(0,P.jsx)(b.Col,{className:x,children:t}),(0,P.jsx)(b.Col,{children:(0,P.jsx)(b.Checkbox,{checked:l,onChange:e=>{const t=e.target.checked?(0,j.union)(r.slice(0),n.map((e=>e.name))):r.slice(0).filter((e=>!n.some((t=>t.name===e))));a(t)},children:(0,P.jsx)(s.FormattedMessage,{id:"selectedAll",moduleName:"ExportTable",defaultMessage:"\u5168\u9009"})})}),(0,P.jsx)(b.Col,{span:24,children:(0,P.jsx)(b.Space,{className:C()("full-space"),wrap:!0,size:[24,12],children:(n||[]).map((e=>(0,P.jsx)(b.Checkbox,{checked:r.some((t=>t===e.name)),onChange:t=>{let n=r.slice(0);t.target.checked?n.push(e.name):n=n.filter((t=>t!==e.name)),a(n)},children:e.titleText||e.title||"\u672a\u547d\u540d\u5217"},e.name)))})})]})})},B=e=>{let{options:t,children:n}=e;return t?(0,P.jsxs)(b.Row,{wrap:!1,children:[(0,P.jsx)(b.Col,{flex:1,className:l,children:n}),(0,P.jsx)(b.Col,{className:o,children:t})]}):n},R=(0,v.forwardRef)(((e,t)=>{let{columns:n,data:a}=e;const[l,o]=(0,v.useState)((()=>{const e=Array.isArray(a)?a:JSON.parse(a)||[];return Array.isArray(e)&&(e||[]).filter((e=>!!e)).length>0?e.filter((e=>!!e)):n.filter((e=>e.hasOwnProperty("exportHidden")&&!0!==e.exportHidden||!0!==e.hidden)).map((e=>e.name))})),f=(0,v.useMemo)((()=>(0,j.groupBy)(n,(e=>e.groupName))),[n]),y=(0,v.useMemo)((()=>{const e=new Map(n.map((e=>[e.name,e])));return(l||[]).filter((e=>n.some((t=>t.name===e)))).map((t=>e.get(t)))}),[n,l]);return(0,v.useImperativeHandle)(t,(()=>({data:l})),[l]),(0,P.jsx)(s.IntlProvider,{importMessages:r,moduleName:"ExportTable",children:(0,P.jsx)(B,{options:(0,P.jsxs)("div",{children:[(0,P.jsxs)("div",{className:h,children:[(0,P.jsxs)("div",{className:x,children:[(0,P.jsx)(s.FormattedMessage,{id:"rightTitle",moduleName:"ExportTable",defaultMessage:"\u5df2\u9009\u7684\u5b57\u6bb5"}),"\uff1a"]}),(0,P.jsx)("div",{className:_,children:(0,P.jsx)(s.FormattedMessage,{id:"rightDesc",moduleName:"ExportTable",defaultMessage:"\u6309\u4f4f\u62d6\u62fd\u53ef\u8fdb\u884c\u6392\u5e8f"})})]}),(0,P.jsx)(T.ReactSortable,{selectedColumns:l,list:y,filter:".ignore-elements",dragClass:m,ghostClass:p,forceFallback:!0,setList:e=>{const t=e.map((e=>e.name));setTimeout((()=>{o([...t])}),50)},animation:300,delayOnTouchStart:!0,delay:2,children:y.map(((e,t)=>(0,P.jsx)(b.List.Item,{className:C()(d,u),children:(0,P.jsxs)(b.Row,{justify:"space-between",align:"middle",style:{flex:1},children:[(0,P.jsx)(b.Col,{children:(0,P.jsxs)(b.Space,{size:2,children:[(0,P.jsx)(k.default,{type:"icon-paixu",className:C()(i,"move-icon")}),(0,P.jsx)("span",{children:e.titleText||e.title||"\u672a\u547d\u540d\u5217"})]})}),(0,P.jsx)(b.Col,{onClick:t=>{t.preventDefault(),t.stopPropagation();let n=l.slice(0);n=n.filter((t=>t!==e.name)),setTimeout((()=>{o([...n])}),50)},children:(0,P.jsx)(k.default,{type:"icon-close-thin",className:C()(c,"close-icon")})})]})},e.name+t)))})]}),children:(0,P.jsx)(b.Space,{className:C()("full-space"),direction:"vertical",split:(0,P.jsx)(b.Divider,{className:g}),children:Object.keys(f).map(((e,t)=>(0,P.jsx)(D,{selected:l,groupName:e,list:f[e],onChange:e=>{o(e)}},e+t)))})})})}));R.defaultProps={columns:[]};const G=e=>t=>{const n=A()(t,["onClick"]),r=(0,v.useRef)(null),{name:s,saveDataApi:l,featureId:o}=t,{exportTableServerApis:i}=(0,S.usePreset)(),c=l||i&&i.saveDataApi,d=(0,N.useModal)();return(0,P.jsx)(e,{onClick:async()=>{t.onClick&&t.onClick();let e="function"===typeof t.columns?await t.columns():t.columns;e=e.filter((e=>!0!==e.exportHidden));const l=(e=>{const t=(0,X.withFetch)(e);return n=>{const{name:r,getDataApi:s}=n,{exportTableServerApis:a}=(0,S.usePreset)(),l=s||a&&a.getDataApi;return r&&a&&a.getDataApi?(0,P.jsx)(t,{...n,...l(r),error:(0,P.jsx)(e,{...n})}):(0,P.jsx)(e,{...n})}})((t=>(e=>{let{children:t}=e;return o?(0,P.jsx)(E.default,{id:o,children:t}):t({})})({children:s=>{let{options:a}=s;return e=e.filter((e=>!Array.isArray(O()(a,"hiddenColumns"))||-1===a.hiddenColumns.indexOf(e.name))),(0,P.jsx)(R,{...t,...n,columns:e,ref:r})}})));d({title:t.title||"\u5bfc\u51fa\u6570\u636e",...n,className:a,footer:()=>(0,P.jsxs)(b.Space,{size:4,className:f,children:[(0,P.jsx)(k.default,{type:"icon-xinxi-miaobian"}),(0,P.jsx)("span",{children:"\u5bfc\u51fa\u540e\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u4fdd\u5b58\u60a8\u672c\u6b21\u9009\u62e9\u7684\u5b57\u6bb5\u53ca\u6392\u5e8f"})]}),footerButtons:[{children:"\u53d6\u6d88"},{type:"primary",children:"\u5bfc\u51fa",onClick:async()=>{var e;if(0===(null===(e=r.current)||void 0===e?void 0:e.data.length))return b.message.error(t.selectedTip||"\u8bf7\u9009\u62e9\u8981\u5bfc\u51fa\u7684\u5b57\u6bb5"),!1;const n=!c||await c({name:s,data:r.current.data});if(!1!==n){(0,X.getCache)().delByCacheName("EXPORT_TABLE_CONFIG_".concat(s));return!1!==(!t.onExport||await t.onExport({data:r.current.data,downloadBlobFile:M.downloadBlobFile}))}return!1!==n}}],children:(0,P.jsx)(l,{...(0,j.pick)(t,["name","getDataApi"])})})}})},z=G((e=>(0,P.jsx)(s.IntlProvider,{importMessages:r,moduleName:"ExportTable",children:(0,P.jsx)(b.Button,{...e,size:"small",children:e.actionText||(0,P.jsx)(s.FormattedMessage,{id:"actionText",moduleName:"ExportTable",defaultMessage:"\u5bfc\u51fa\u6570\u636e"})})})))},53872:e=>{e.exports=function(e,t,n,r){for(var s=-1,a=null==e?0:e.length;++s<a;){var l=e[s];t(r,l,n(l),e)}return r}},93912:(e,t,n)=>{var r=n(2168);e.exports=function(e,t,n,s){return r(e,(function(e,r,a){t(s,e,n(e),a)})),s}},2168:(e,t,n)=>{var r=n(82928),s=n(83924)(r);e.exports=s},40444:e=>{e.exports=function(e,t){for(var n,r=-1,s=e.length;++r<s;){var a=t(e[r]);void 0!==a&&(n=void 0===n?a:n+a)}return n}},20860:(e,t,n)=>{var r=n(53872),s=n(93912),a=n(15908),l=n(42336);e.exports=function(e,t){return function(n,o){var i=l(n)?r:s,c=t?t():{};return i(n,e,a(o,2),c)}}},83924:(e,t,n)=>{var r=n(71692);e.exports=function(e,t){return function(n,s){if(null==n)return n;if(!r(n))return e(n,s);for(var a=n.length,l=t?a:-1,o=Object(n);(t?l--:++l<a)&&!1!==s(o[l],l,o););return n}}},59888:(e,t,n)=>{var r=n(6056),s=n(56460);e.exports=function(e,t,n){var a=null==e?0:e.length;return a?(t=n||void 0===t?1:s(t),r(e,0,(t=a-t)<0?0:t)):[]}},48812:(e,t,n)=>{var r=n(84456),s=n(20860),a=Object.prototype.hasOwnProperty,l=s((function(e,t,n){a.call(e,n)?e[n].push(t):r(e,n,[t])}));e.exports=l},91400:(e,t,n)=>{var r=n(29852);e.exports=function(e,t,n){var s=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===s?r(e,t,void 0,n):!!s}},81620:(e,t,n)=>{var r=n(40444),s=n(12208);e.exports=function(e){return e&&e.length?r(e,s):0}},56460:(e,t,n)=>{var r=n(92676);e.exports=function(e){var t=r(e),n=t%1;return t===t?n?t-n:t:0}},15904:()=>{},88384:()=>{}}]);
//# sourceMappingURL=7244.c99d9a82.chunk.js.map